#include <hls_opencv.h>
#include <stdint.h>
#include <stdio.h>

using namespace cv;
/*#pragma HLS INTERFACE m_axi depth=2073600 port=image_out offset=slave bundle=CRTL_BUS
#pragma HLS INTERFACE m_axi depth=2073600 port=image_in offset=slave bundle=CRTL_BUS*/
void Sobel(unsigned char * image_in, unsigned char * image_out);

int main(){

		//Mat im = imread("go_800.jpg",CV_LOAD_IMAGE_GRAYSCALE);
		unsigned char image_in[10*10] = {
				0xff, 0xd8, 0xff, 0xe1, 0x00, 0x16, 0x45, 0x78, 0x69, 0x66, 0x00, 0x00, 0x4d, 0x4d, 0x00, 0x2a,
				0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xdb, 0x00, 0x84, 0x00, 0x03,
				0x02, 0x02, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
				0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
				0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x0a, 0x08, 0x08, 0x08,
				0x08, 0x0a, 0x0a, 0x0a, 0x08, 0x08, 0x0b, 0x0d, 0x0a, 0x08, 0x0d, 0x08, 0x08, 0x0a, 0x08, 0x01,
				0x03, 0x04, 0x04, 0x06};

		unsigned char image_out[10*10];

		//memcpy(image_in,im.data,sizeof(uint8_t)*10*10);

		Sobel(image_in, image_out);

		Mat out = Mat(10,10,CV_8UC1,image_out);

		IplImage image = IplImage(out);
		cvSaveImage("pri_800.jpg", &image);//save file in \...\Vivado_Sobel_v3\solution1\csim\build

		namedWindow("test");
		imshow("test",out);
		waitKey(0);
		return 0;
}
